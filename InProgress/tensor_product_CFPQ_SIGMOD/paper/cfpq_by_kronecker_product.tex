\section{Context-free path querying by Kronecker product}


In this section we introduce the algorithm for CFPQ which is based on Kronecker product of Boolean matrices.
The algorithm solves all-pairs CFPQ in all-path semantics (according to~\cite{hellingsPathQuerying}) and works in two steps.
\begin{enumerate}
\item \emph{Index creation}.
 In this step, the algorithm computes an index which contains information necessary to restore paths for given pairs of vertices.
 This index can be used to solve the reachability problem without extracting paths.
 Note that this index is finite even if the set of paths is infinite.
\item \emph{Paths extraction}.
All paths for the given pair of vertices can be enumerated by using the index.
Since the set of paths can be infinite, all paths cannot be enumerated explicitly, and advanced techniques such as lazy evaluation are required for the implementation.
Nevertheless, a single path can always be extracted with standard techniques.
\end{enumerate}

In the following subsections we describe these steps, prove correctness of the algorithm, and provide time complexity estimations.
For the first step we firstly introduce na{\"i}ve algortihm. After that we show how to achieve cubic time complexity by using dynamic transitive closure algorithm and shave off a logarithmic factor to achive the best known time complexity for CFPQ.

After that we provide step-by-step example of query evaluation by using the proposed algorithm.

\input{index_creation_algorithm}
\input{paths_extraction_algorithm}
\input{algorithm_example}